<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Liste SuperHéros</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios@latest"></script>
</head>
<body class="container">
<div id="navbar-placeholder"></div>


  <div id="app">
    <h1 class="my-4">Liste des superhéros</h1>

      <div class="form-check mb-3">
          <input type="checkbox" v-model="afficherPouvoirs" id="afficherPouvoirs">Afficher les pouvoirs
      </div>

      <div class="input-group mb-3">
          <span class="input-group-text">Rechercher par nom</span>
          <input
                  type="text"
                  class="form-control"
                  v-model="searchQuery"
                  placeholder="Entrez le nom d'un superhéros..."
                  aria-label="Rechercher par nom">
      </div>
      <button class="btn btn-primary mb-3" @click="searchQuery=''">Réinitialiser</button>

      <div class="mb-3">
          <small class="text-muted">{{ filteredSuperheros.length }} superhéros trouvés</small>
      </div>

      <div class="list-group">
          <a href="#" class="list-group-item list-group-item-action" v-for="hero in filteredSuperheros" :key="hero.id"  @click="navigateToDetail(hero.id)">
              <div class="d-flex w-100 justify-content-between align-items-center">
                  <h5 class="mb-1">{{ hero.name }}</h5>
                  <img :src="hero.images.md" class="rounded-circle" width="50px">
                  <p v-if="afficherPouvoirs">
                      Intelligence: {{ hero.powerstats.intelligence }}
                      Force: {{ hero.powerstats.strength }}
                      Vitesse: {{ hero.powerstats.speed }}
                      Durabilité: {{ hero.powerstats.durability }}
                      Pouvoir: {{ hero.powerstats.power }}
                      Combat: {{ hero.powerstats.combat }}
                  </p>
                  <small>{{ hero.id }}</small>
              </div>
          </a>
      </div>
  </div>
<script>
    fetch('navbar.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('navbar-placeholder').innerHTML = data;
        })

</script>
  <script>
     const app = Vue.createApp({
        data() {
        return {
            superheros: [], //initialisation d'une liste vide superHeros
            afficherPouvoirs: false, //Les pouvoirs ne sont pas afficher par défaut
            searchQuery: '', //Valeur par défaut de la recherche vide
        }
        },
         methods: {
            navigateToDetail(heroId) {
                window.location.href = `detail.html?id=${heroId}`;
           }
         },
         computed: {
             filteredSuperheros() {
                 if (!this.searchQuery) {
                     return this.superheros;
                 }

                 const query = this.searchQuery.toLowerCase();
                 return this.superheros.filter(hero => {
                     return hero.name.toLowerCase().includes(query);
                 });
             }
         },
         mounted() {
            axios.get('https://cdn.jsdelivr.net/gh/rtomczak/superhero-api@0.3.0/api/all.json')
              .then(response => {
                this.superheros = response.data; // Récupérer les données des superhéros
              })
              .catch(error => {
                console.log(error);
              });
    },
  });
    app.mount('#app');
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>